#####################################
#           INCLUDES                #
#####################################

[include BTT_EBB_SB2209.cfg]
[include mainsail.cfg]
[include eddy.cfg]
[include leds.conf]
[include macros.cfg]
#[include sfs.conf]

#####################################
#           BASICS                  #
#####################################

[mcu]
#serial: /dev/serial/by-id/usb-Klipper_stm32g0b1xx_m5p-if00
canbus_uuid: a71730cf9060

[printer]
kinematics: corexz
max_velocity: 300
max_accel: 3000
max_z_velocity: 5
max_z_accel: 100

#####################################
#           STEPPER                 #
#####################################

[stepper_x]
step_pin: PC8
dir_pin: PC9
enable_pin: !PA15
microsteps: 32
rotation_distance: 40
full_steps_per_rotation: 200
endstop_pin: EBBCan:gpio24
position_endstop: 300
position_max: 300
homing_speed: 50

[tmc2209 stepper_x]
uart_pin: PD9
run_current: 1.4
diag_pin: PD3
stealthchop_threshold: 999999

[stepper_y]
step_pin: PA10
dir_pin: !PA14
enable_pin: !PA13
microsteps: 32
rotation_distance: 40
full_steps_per_rotation: 200
endstop_pin: PD2
position_endstop: -15
position_max: 300
position_min: -15
homing_speed: 50

[tmc2209 stepper_y]
uart_pin: PD8
run_current: 1.4
diag_pin: PD2
stealthchop_threshold: 999999

[stepper_z]
step_pin: PC6
dir_pin: PC7
enable_pin: !PA9
microsteps: 32
rotation_distance: 40
full_steps_per_rotation: 200
endstop_pin: probe:z_virtual_endstop
# position_endstop: 0.0
position_max: 200

[tmc2209 stepper_z]
uart_pin: PB10
run_current: 1.4
diag_pin: PC3
stealthchop_threshold: 999999

#####################################
#           TEMPERATURE             #
#####################################

[temperature_sensor Manta]
sensor_type              : temperature_mcu
sensor_mcu               : mcu

[temperature_sensor CB1]
sensor_type: temperature_host

[temperature_fan electronics_compartment]
pin: PA4
sensor_type: temperature_host
off_below: 0.4
min_temp: 10
max_temp: 90
target_temp: 30
control: pid
pid_Kp: 2
pid_Ki: 4
pid_Kd: 0.1

[heater_bed]
heater_pin: PA5
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PA0
control: pid
min_temp: 0
max_temp: 150
pid_kp = 58.190
pid_ki = 1.220
pid_kd = 693.920

[temperature_sensor chamber]
sensor_type: Generic 3950
sensor_pin: PA1
min_temp: 0
max_temp: 100

[fan_generic nevermore]
pin: PA3

[board_pins]
aliases:
    # EXP1 header
    EXP1_1=PD5, EXP1_3=PB3, EXP1_5=PB5, EXP1_7=PB7, EXP1_9=<GND>,
    EXP1_2=PD4,  EXP1_4=PD6, EXP1_6=PB4, EXP1_8=PB6, EXP1_10=<5V>,
    # EXP2 header
    EXP2_1=PB14, EXP2_3=PB8, EXP2_5=PC10, EXP2_7=PC12,  EXP2_9=<GND>,
    EXP2_2=PB13, EXP2_4=PB9, EXP2_6=PB15, EXP2_8=<RST>, EXP2_10=<NC>

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [probe_eddy_current btt_eddy]
#*# reg_drive_current = 15
#*# calibrate =
#*# 	0.050000:3219654.898,0.087500:3219161.984,0.131250:3218554.577,
#*# 	0.168750:3218027.126,0.212500:3217494.611,0.250000:3217011.468,
#*# 	0.287500:3216544.254,0.331250:3216015.562,0.368750:3215527.788,
#*# 	0.412500:3215037.970,0.450000:3214578.152,0.487500:3214139.768,
#*# 	0.531250:3213550.815,0.568750:3213089.047,0.612500:3212573.470,
#*# 	0.650000:3212169.008,0.687500:3211713.588,0.731250:3211212.821,
#*# 	0.768750:3210775.251,0.812500:3210298.442,0.850000:3209908.721,
#*# 	0.887500:3209513.004,0.931250:3208989.535,0.968750:3208585.205,
#*# 	1.012500:3208142.763,1.050000:3207787.151,1.087500:3207417.122,
#*# 	1.131250:3206991.110,1.168750:3206629.977,1.212500:3206231.872,
#*# 	1.250000:3205930.437,1.287500:3205552.493,1.331250:3205109.700,
#*# 	1.368750:3204747.103,1.412500:3204355.160,1.450000:3204062.221,
#*# 	1.487500:3203727.257,1.531250:3203350.954,1.568750:3203040.581,
#*# 	1.612500:3202692.712,1.650000:3202392.116,1.687500:3202095.555,
#*# 	1.731250:3201734.716,1.768750:3201381.223,1.812500:3201087.689,
#*# 	1.850000:3200802.730,1.887500:3200531.770,1.931250:3200190.929,
#*# 	1.968750:3199911.155,2.012500:3199611.811,2.050000:3199368.195,
#*# 	2.087500:3199083.112,2.131250:3198783.932,2.168750:3198499.178,
#*# 	2.212500:3198237.082,2.250000:3197999.591,2.287500:3197737.128,
#*# 	2.331250:3197460.253,2.368750:3197219.139,2.412500:3196979.904,
#*# 	2.450000:3196744.784,2.487500:3196534.485,2.531250:3196241.866,
#*# 	2.568750:3196014.564,2.612500:3195776.369,2.650000:3195566.465,
#*# 	2.687500:3195359.770,2.731250:3195110.426,2.768750:3194901.280,
#*# 	2.812500:3194672.290,2.850000:3194492.723,2.887500:3194296.573,
#*# 	2.931250:3194044.667,2.968750:3193866.484,3.012500:3193655.994,
#*# 	3.050000:3193505.237,3.087500:3193318.351,3.131250:3193115.872,
#*# 	3.168750:3192945.994,3.212500:3192753.898,3.250000:3192600.876,
#*# 	3.287500:3192421.471,3.331250:3192214.753,3.368750:3192067.433,
#*# 	3.412500:3191857.770,3.450000:3191721.491,3.487500:3191557.513,
#*# 	3.531250:3191416.966,3.568750:3191248.242,3.612500:3191087.548,
#*# 	3.650000:3190955.859,3.687500:3190809.488,3.731250:3190626.522,
#*# 	3.768750:3190491.233,3.812500:3190347.133,3.850000:3190195.492,
#*# 	3.887500:3190103.255,3.931250:3189931.102,3.968750:3189798.608,
#*# 	4.012500:3189646.640,4.050000:3189527.994
#*#
#*# [temperature_probe btt_eddy]
#*# calibration_temp = 36.209002
